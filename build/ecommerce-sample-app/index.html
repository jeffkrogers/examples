<html>
  <head>
    <meta charset="utf-8" />
    <link href="https://cdn.reflect.io/latest/reflect.css" rel="stylesheet" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

    <title>Ecommerce Sample App</title>

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />

    <!--  Bootstrap core CSS  -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">


    <link href="assets/css/mono-theme.css" rel="stylesheet"/>
    <link href="assets/css/main.css" rel="stylesheet"/>
  </head>
  <body>

      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
          <div class="navbar-header">
            <a class="navbar-brand" href="https://reflect.github.io/examples/"><b>Simple</b>Shop | Customer Portal</a>

            <!-- Mobile Hamburger -->
            <div class="hidden-sm hidden-md hidden-lg hidden-xl">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mobile-menu">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <div class="collapse navbar-collapse" id="mobile-menu">
                <ul class="nav navbar-nav">
                  <a class="navigation" name="Sales" href="#sales">Sales</a>|
                  <a class="navigation" name="Inventory" href="#inventory">Inventory</a>|
                  <a class="navigation" name="Invoices" href="#invoices">Invoices</a>
                </ul>
              </div>
            </div>
          </div>

          <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-left">
              <li><a name="Sales" class="navigation active" href="#sales">Sales</a></li>
              <li><a name="Inventory" class="navigation" href="#inventory">Inventory</a></li>
              <li><a name="Invoices" class="navigation" href="#invoices">Invoices</a></li>
            </ul>
            <!-- Settings -->
            <ul class="nav navbar-nav navbar-right ">
              <li class="dropdown settings hidden-xs">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <img class="avatar" src="assets/img/user-avatar.png" alt="user avatar">
                  Tom Scott
                </a>
                <ul class="dropdown-menu">
                  <li><a href="#">Settings</a></li>
                  <li class="divider"></li>
                  <li><a href="#">Log out</a></li>
                </ul>
              </li>
						</ul>
          </div>
        </div>
      </nav>

      <div class="sidebar hidden-tablet">
        <div class="nav-group">
          <h4>Date range</h4>
          <label class="switch">
            <input id="dates-toggle" type="checkbox">
            <div class="slider round"></div>
          </label>
          <label class="date-toggle toggle">Last month</label><br>
          <label class="date-toggle toggle">Last week</label>
        </div>
        <div class="nav-group">
          <h4>Customer type</h4>
          <label class="switch">
            <input id="types-toggle" type="checkbox">
            <div class="slider round"></div>
          </label>
          <label class="type-toggle toggle">Business</label><br>
          <label class="type-toggle toggle">Home</label>
        </div>
      </div>

      <!-- Where the view gets rendered -->
      <div class="view-container">
        <div id="view"></div>
      </div>

      <!--   Core JS Files   -->
    	<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>

      <!--   Moment JS   -->
      <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.3/moment.js"></script>

    	<!--  Reflect JS -->
      <script src="https://cdn.reflect.io/latest/reflect.js"></script>
      <script type="text/javascript">

        // call to switch Reflect views
        function render(ui, view) {
          switch(view) {
            case 'Sales':
                renderDefault(ui);

                break;
            case 'Inventory':
                ui.view(document.getElementById('view'), 'ohcofAiwRdyNMMaJDwb6ag');

                break;
            case 'Invoices':
                ui.view(document.getElementById('view'), 'WC51OmKZQE-lN9RVik0U0Q');

                break;
            default:
                renderDefault(ui);
          }
        };

        // call to render default view
        function renderDefault(ui) {
          if ($(window).width() < 750) {
            ui.view(document.getElementById('view'), 'cP4YDx39QcyOgGTmhJQiAA');
          } else {
            ui.view(document.getElementById('view'), 'gf3vzhAJRy23C_4Fxg6ayg');
          }
        }

        // call to filter by customer type
        function filterByCustomer(ui, tags) {
          var customer = {
            field: 'Customer Segment',
            op: '=',
            any: tags,
            removable: true
          }

          ui.withFilters([customer]);
        }

        // call to update active nav item
        function updateNav(item) {
          $('a.navigation').removeClass('active');
          $('a.navigation[name=' + item + ']').addClass('active');
        }

        //instantiate new instance
        var ui = new ReflectUI();

        // swap views with navigation
        $('a.navigation').click(function(e) {
          var page = e.target.name;

          updateNav(page)
          render(ui, page);
        });

        // render the default view
        renderDefault(ui);

        // date toggle
        var oneMonth = moment().subtract(1,'month').format('YYYY-MM-DD');
        var oneWeek = moment().subtract(7,'d').format('YYYY-MM-DD');
        var today = moment().format('YYYY-MM-DD');
        var monthly = true;

        $('#dates-toggle').change(function() {
          var page = $('a.navigation.active').attr('name');
          monthly = !monthly;

          if (monthly) {
            ui.withDates([oneMonth, today]);
          } else {
            ui.withDates([oneWeek, today]);
          }

          $('.btn-download').attr('href');
          render(ui, page);
        });

        $('.date-toggle').click(function() {
          $('#dates-toggle').click();
        });

        var business = true;

        $('#types-toggle').change(function() {
          var page = $('a.navigation.active').attr('name');
          business = !business;

          if (business) {
            filterByCustomer(ui, ['Corporate', 'Small Business']);
          } else {
            filterByCustomer(ui, ['Consumer', 'Home Office']);
          }

          render(ui, page);
        });

        $('.type-toggle').click(function() {
          $('#types-toggle').click();
        });


      </script>

      <!-- Swap views for better mobile viewing -->
    	<script type="text/javascript">
    		var startSize = $(window).width();
    		window.onresize = function(event) {
    			if ($(window).width() < 750 && startSize >= 750) {
    				ui.view(document.getElementById('view'), 'cP4YDx39QcyOgGTmhJQiAA');
    			} else if ($(window).width() >= 750 && startSize < 750) {
    				ui.view(document.getElementById('view'), 'gf3vzhAJRy23C_4Fxg6ayg');
    			}

    			startSize = $(window).width();
    		};
    	</script>
  </body>
</html>
